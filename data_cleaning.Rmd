---
title: "Young People Survey Cleaning"
author: "Adina Zhang"
date: "April 26, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(lattice)
library(caret)
library(corrplot)
```

```{r}
survey = read_csv("responses.csv") %>% janitor::clean_names()
names(survey)

#List Predictors and Outcome of Interest
vars <-c(#Predictors
  "metal_or_hardrock", "punk", "horror", "thriller", "war", "action",
  "countryside_outdoors", "active_sport", "adrenaline_sports", "cars",
  "fear_of_public_speaking",
  "smoking", "alcohol",
  "criminal_damage", "cheating_in_school", "small_big_dogs", "prioritising_workload","assertiveness", "parents_advice",
         #Outcome
         "gender")

#Subset Data
survey_new <-survey[vars] 

#Recoding Data
survey_new$gender <- recode(survey_new$gender, "male" = 1, "female" = 0)

survey_new$alcohol <- recode(survey_new$alcohol, "drink a lot" = 2, "social drinker" = 1, "never" = 0)

survey_new$smoking <- recode(survey_new$smoking, "never smoked" = 0, "former smoker" = 2, "tried smoking" = 3, "current smoker" = 4)

#Count Missing Entries
sapply(survey_new, function(x)sum(is.na(survey_new))) %>% print()
```

#EDA
```{r eda}
eda <-survey_new %>% na.omit() 

# matrix of predictors 
x  <- eda
x$gender <- NULL


#matrix predictors with dummy variables
x_dummy <-model.matrix(gender~.,eda)[,-1]

# vector of response
y <- eda$gender 

cor(x) %>% corrplot()

```

#PCA
```{r}
pca <- prcomp(eda)
```